<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" data-diagram-type="SEQUENCE" height="688px" preserveAspectRatio="none" style="width:656px;height:688px;background:#FFFFFF;" version="1.1" viewBox="0 0 656 688" width="656px" zoomAndPan="magnify"><defs/><g><rect fill="none" height="159.6641" style="stroke:#000000;stroke-width:1.5;" width="441.9136" x="197.4596" y="160.6953"/><g><title>&#20027;&#32447;&#31243;</title><rect fill="#000000" fill-opacity="0.00000" height="617.2578" width="8" x="28.9999" y="36.2969"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="32" x2="32" y1="36.2969" y2="653.5547"/></g><g><title>&#35843;&#24230;&#32447;&#31243;</title><rect fill="#000000" fill-opacity="0.00000" height="617.2578" width="8" x="238.4594" y="36.2969"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="241.4596" x2="241.4596" y1="36.2969" y2="653.5547"/></g><g><title>IO&#32447;&#31243;</title><rect fill="#000000" fill-opacity="0.00000" height="617.2578" width="8" x="498.605" y="36.2969"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="502.0309" x2="502.0309" y1="36.2969" y2="653.5547"/></g><g class="participant participant-head" data-participant="Main"><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="55.9998" x="5" y="5"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="41.9998" x="12" y="24.9951">&#20027;&#32447;&#31243;</text></g><g class="participant participant-tail" data-participant="Main"><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="55.9998" x="5" y="652.5547"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="41.9998" x="12" y="672.5498">&#20027;&#32447;&#31243;</text></g><g class="participant participant-head" data-participant="Scheduler"><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="69.9998" x="207.4596" y="5"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="55.9998" x="214.4596" y="24.9951">&#35843;&#24230;&#32447;&#31243;</text></g><g class="participant participant-tail" data-participant="Scheduler"><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="69.9998" x="207.4596" y="652.5547"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="55.9998" x="214.4596" y="672.5498">&#35843;&#24230;&#32447;&#31243;</text></g><g class="participant participant-head" data-participant="IO"><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="57.1483" x="474.0309" y="5"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="43.1483" x="481.0309" y="24.9951">IO&#32447;&#31243;</text></g><g class="participant participant-tail" data-participant="IO"><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="57.1483" x="474.0309" y="652.5547"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="43.1483" x="481.0309" y="672.5498">IO&#32447;&#31243;</text></g><rect fill="#EEEEEE" height="3" style="stroke:#EEEEEE;stroke-width:1;" width="649.3732" x="0" y="66.8633"/><line style="stroke:#000000;stroke-width:1;" x1="0" x2="649.3732" y1="66.8633" y2="66.8633"/><line style="stroke:#000000;stroke-width:1;" x1="0" x2="649.3732" y1="69.8633" y2="69.8633"/><rect fill="#EEEEEE" height="23.1328" style="stroke:#000000;stroke-width:2;" width="187.5261" x="230.9235" y="56.2969"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="169.0002" x="236.9235" y="72.3638">&#20027;&#32447;&#31243;&#25552;&#20132;&#25968;&#25454;&#35302;&#21457;&#25209;&#37327;&#20889;&#20986;</text><g class="message" data-participant-1="Main" data-participant-2="Scheduler"><polygon fill="#181818" points="230.4594,106.5625,240.4594,110.5625,230.4594,114.5625,234.4594,110.5625" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="32.9999" x2="236.4594" y1="110.5625" y2="110.5625"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="97.0747" x="39.9999" y="105.4966">dump(Surface)</text></g><path d="M247,123.5625 L247,148.5625 L415,148.5625 L415,133.5625 L405,123.5625 L247,123.5625" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M405,123.5625 L405,133.5625 L415,133.5625 L405,123.5625" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="147.1197" x="253" y="140.6294">&#22635;&#20805;&#21040; active_batches_</text><path d="M197.4596,160.6953 L362.3161,160.6953 L362.3161,167.8281 L352.3161,177.8281 L197.4596,177.8281 L197.4596,160.6953" fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="159.6641" style="stroke:#000000;stroke-width:1.5;" width="441.9136" x="197.4596" y="160.6953"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="119.8565" x="212.4596" y="173.7622">&#24403;&#36798;&#21040; batch_size</text><g class="message" data-participant-1="Scheduler" data-participant-2="IO"><polygon fill="#181818" points="490.605,194.9609,500.605,198.9609,490.605,202.9609,494.605,198.9609" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="242.4594" x2="496.605" y1="198.9609" y2="198.9609"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="121.5449" x="249.4594" y="193.895">io_cv_.notify_one()</text></g><g class="message" data-participant-1="IO" data-participant-2="IO"><line style="stroke:#181818;stroke-width:1;" x1="502.605" x2="544.605" y1="228.0938" y2="228.0938"/><line style="stroke:#181818;stroke-width:1;" x1="544.605" x2="544.605" y1="228.0938" y2="241.0938"/><line style="stroke:#181818;stroke-width:1;" x1="503.605" x2="544.605" y1="241.0938" y2="241.0938"/><polygon fill="#181818" points="513.605,237.0938,503.605,241.0938,513.605,245.0938,509.605,241.0938" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="117.7681" x="509.605" y="223.0278">&#25191;&#34892;io_func_&#25209;&#37327;&#20889;</text></g><g class="message" data-participant-1="IO" data-participant-2="Scheduler"><polygon fill="#181818" points="253.4594,266.2266,243.4594,270.2266,253.4594,274.2266,249.4594,270.2266" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="247.4594" x2="501.605" y1="270.2266" y2="270.2266"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="211.9419" x="259.4594" y="265.1606">&#25552;&#20132;future&#21040;completed_batches_</text></g><g class="message" data-participant-1="Scheduler" data-participant-2="Scheduler"><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="242.4594" x2="284.4594" y1="299.3594" y2="299.3594"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="284.4594" x2="284.4594" y1="299.3594" y2="312.3594"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="243.4594" x2="284.4594" y1="312.3594" y2="312.3594"/><polygon fill="#181818" points="253.4594,308.3594,243.4594,312.3594,253.4594,316.3594,249.4594,312.3594" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="130.0002" x="249.4594" y="294.2935">&#22238;&#25910;&#36164;&#28304;&#24182;&#21796;&#37266;&#20027;&#32447;&#31243;</text></g><rect fill="#EEEEEE" height="3" style="stroke:#EEEEEE;stroke-width:1;" width="649.3732" x="0" y="347.9258"/><line style="stroke:#000000;stroke-width:1;" x1="0" x2="649.3732" y1="347.9258" y2="347.9258"/><line style="stroke:#000000;stroke-width:1;" x1="0" x2="649.3732" y1="350.9258" y2="350.9258"/><rect fill="#EEEEEE" height="23.1328" style="stroke:#000000;stroke-width:2;" width="187.5261" x="230.9235" y="337.3594"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="169.0002" x="236.9235" y="353.4263">&#20027;&#32447;&#31243;&#36164;&#28304;&#19981;&#36275;&#35302;&#21457;&#24378;&#21046;&#21047;&#26032;</text><g class="message" data-participant-1="Main" data-participant-2="Scheduler"><polygon fill="#181818" points="230.4594,387.625,240.4594,391.625,230.4594,395.625,234.4594,391.625" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="32.9999" x2="236.4594" y1="391.625" y2="391.625"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="129.6827" x="39.9999" y="386.5591">dump() &#20294;&#26080;&#36164;&#28304;&#21487;&#29992;</text></g><g class="message" data-participant-1="Scheduler" data-participant-2="IO"><polygon fill="#181818" points="490.605,416.7578,500.605,420.7578,490.605,424.7578,494.605,420.7578" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="242.4594" x2="496.605" y1="420.7578" y2="420.7578"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="216.8614" x="249.4594" y="415.6919">&#35774;&#32622;need_immediate_flush_=true</text></g><g class="message" data-participant-1="IO" data-participant-2="IO"><line style="stroke:#181818;stroke-width:1;" x1="502.605" x2="544.605" y1="449.8906" y2="449.8906"/><line style="stroke:#181818;stroke-width:1;" x1="544.605" x2="544.605" y1="449.8906" y2="462.8906"/><line style="stroke:#181818;stroke-width:1;" x1="503.605" x2="544.605" y1="462.8906" y2="462.8906"/><polygon fill="#181818" points="513.605,458.8906,503.605,462.8906,513.605,466.8906,509.605,462.8906" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="104.0001" x="509.605" y="444.8247">&#31435;&#21363;&#22788;&#29702;&#26410;&#28385;&#25209;&#27425;</text></g><g class="message" data-participant-1="IO" data-participant-2="Scheduler"><polygon fill="#181818" points="253.4594,488.0234,243.4594,492.0234,253.4594,496.0234,249.4594,492.0234" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="247.4594" x2="501.605" y1="492.0234" y2="492.0234"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="65.4951" x="259.4594" y="486.9575">future&#20837;&#38431;</text></g><g class="message" data-participant-1="Scheduler" data-participant-2="Main"><polygon fill="#181818" points="43.9999,517.1563,33.9999,521.1563,43.9999,525.1563,39.9999,521.1563" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="37.9999" x2="241.4594" y1="521.1563" y2="521.1563"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="185.4595" x="49.9999" y="516.0903">cv_main_.notify_all()&#37322;&#25918;&#36164;&#28304;</text></g><rect fill="#EEEEEE" height="3" style="stroke:#EEEEEE;stroke-width:1;" width="649.3732" x="0" y="549.7227"/><line style="stroke:#000000;stroke-width:1;" x1="0" x2="649.3732" y1="549.7227" y2="549.7227"/><line style="stroke:#000000;stroke-width:1;" x1="0" x2="649.3732" y1="552.7227" y2="552.7227"/><rect fill="#EEEEEE" height="23.1328" style="stroke:#000000;stroke-width:2;" width="190.4142" x="229.4795" y="539.1563"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="171.8884" x="235.4795" y="555.2231">IO&#32447;&#31243;&#24322;&#27493;&#23436;&#25104;&#21518;&#30340;&#36164;&#28304;&#22238;&#25910;</text><g class="message" data-participant-1="IO" data-participant-2="Scheduler"><polygon fill="#181818" points="253.4594,589.4219,243.4594,593.4219,253.4594,597.4219,249.4594,593.4219" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="247.4594" x2="501.605" y1="593.4219" y2="593.4219"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="236.1456" x="259.4594" y="588.356">Future&#23436;&#25104;&#65292;&#35302;&#21457;promise.set_value()</text></g><g class="message" data-participant-1="Scheduler" data-participant-2="Scheduler"><line style="stroke:#181818;stroke-width:1;" x1="242.4594" x2="284.4594" y1="622.5547" y2="622.5547"/><line style="stroke:#181818;stroke-width:1;" x1="284.4594" x2="284.4594" y1="622.5547" y2="635.5547"/><line style="stroke:#181818;stroke-width:1;" x1="243.4594" x2="284.4594" y1="635.5547" y2="635.5547"/><polygon fill="#181818" points="253.4594,631.5547,243.4594,635.5547,253.4594,639.5547,249.4594,635.5547" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="184.9073" x="249.4594" y="617.4888">future.get(), &#22238;&#25910;Surface&#32034;&#24341;</text></g><!--SRC=[VPBBRjD058RtynIZhc89yW2Hp18f2yYY3s0PUvoCv9licKYmXDnA4s8WvL8G49HUH254AeJMJSBBPCREYbV0ZbtN8HAxaSv_pl-VxumjEmGhs9PD0dUM5rU1_piutT-1iWlloTW4ThuUJfum_pWdsLLgIAKwSZPrvKfEKwu088emcytxtj8VyOC9xut3asFMVyxtBbVjFckzPMqVYYA8ZU7jEpVJIr2bXbtOfOucAqW0zos2e8EhDG8jBIzZmpFMRBBE1CeAmNKaFP19L7Kb0AgEHMt8vY_3nI8Mh2kIYnyXa0s8JSkL4iIMfDIbecaHh3sKB1CL152kN5Vvtaaux4OQZPgAb8LF5RaqoQOQ9TH1aQLY6RQE259lKkMSDrlPkmzyC0r_DhZliSif6unMhHSPGe1CTHDgebnUzCBfUGALpNpMcRBEB_vgyZ-e0bpEM_prfzIh_pqOd6uJ2SUBO3usKHGU6mPIiKoGfEdKhKaYSIZAuGdEzbdld8qQWTVYxx_mgs64Y7yTRlD9oJIFLcy-_eCYJbk2qH6Cw95TGjRrWh1gF-M3HH9t3U7wjx7PO_xjY8sxlECnxrbms4XtMhEC6Mmbk9iaMBVycNKJShPZ6TX5HHSHgIxhDBx-1f2j5OfLH0h2hVHgwJSDVdnciuE_]--></g></svg>